package hendek.utilisateur;

import java.sql.Connection;
import java.sql.Date;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.HashMap;
import java.util.Map;

public class User {

		private HashMap<String,String> mdp;//1
		private HashMap<String,String> nom;//2
		private HashMap<String,String> prenom;//3
		private HashMap<String,String> address;//4
		private HashMap<String,String> mail;//5
		private HashMap<String,Date> dateins;//6
		private HashMap<String,String> tel;//7
		private HashMap<String,Integer> droit;//8
		private HashMap<String,String> tok;//9
		
		private static User singleton = null;
		
		public User getInstance(){
			if(singleton==null){
				singleton=new User();
			}
			return singleton;
		}
		
		private User(){
			mdp=new HashMap<>();nom=new HashMap<>();
			prenom=new HashMap<>();address=new HashMap<>();
			mail=new HashMap<>();dateins=new HashMap<>();
			tel=new HashMap<>();droit=new HashMap<>();
			tok=new HashMap<>();Connection con = null;
			try{

			    Class.forName("org.postgresql.Driver");
				String url = "jdbc:postgresql://217.182.171.28:5432/hendek";
				String nom = "postgres";
				String mdp = "Florian2*";
				con = DriverManager.getConnection(url,nom,mdp);

				Statement stmt = con.createStatement();
				stmt = con.createStatement();

				String query = "select * from utilisateur";
				ResultSet rs = stmt.executeQuery(query);
				
				while(rs.next()){
					this.mdp.put(rs.getString("login"),rs.getString("mdp"));
					this.nom.put(rs.getString("login"),rs.getString("nom"));
					prenom.put(rs.getString("login"),rs.getString("prenom"));
					address.put(rs.getString("login"),rs.getString("address"));
					mail.put(rs.getString("login"),rs.getString("mail"));

					dateins.put(rs.getString("login"),rs.getDate("dateins"));
					tel.put(rs.getString("login"),rs.getString("tel"));
					droit.put(rs.getString("login"),rs.getInt("droit"));
					tok.put(rs.getString("login"),rs.getString("tok"));
				}
				
			
				
			}catch (Exception e) {
				System.out.println("[ERROR]"+e.getMessage()+"");
			}finally{	  
				try{
					con.close();
				}catch(Exception e){
					System.out.println("[ERROR]"+e.getMessage()+"");
				}
			}
			
		}
		
		
		public boolean signIn(String pseudo,String password){
			boolean ret=false;
			for(String key:mdp.keySet())
				if(pseudo.equals(key)&&password.equals(mdp.get(key)))
					ret=true;
			
			return ret;				
		}
		
		
		public String getLog(String login){
			for(String key:mdp.keySet())
				if(key.equals(login))
					return mdp.get(key);
			return null;
		}
		
		public String getNom(String login){
			for(String key:nom.keySet())
				if(key.equals(login))
					return nom.get(key);
			return null;
		}
		
		public String getPrenom(String login){
			for(String key:prenom.keySet())
				if(key.equals(login))
					return prenom.get(key);
			return null;
		}
		
		public String getAddress(String login){
			for(String key:address.keySet())
				if(key.equals(login))
					return address.get(key);
			return null;
		}
		
		public String getMail(String login){
			for(String key:mail.keySet())
				if(key.equals(login))
					return mail.get(key);
			return null;
		}
		
		public Date getInscription(String login){
			for(String key:dateins.keySet())
				if(key.equals(login))
					return dateins.get(key);
			return null;
		}
		
		public String getTel(String login){
			for(String key:tel.keySet())
				if(key.equals(login))
					return tel.get(key);
			return null;
		}
		
		public int getDroit(String login){
			for(String key:droit.keySet())
				if(key.equals(login))
					return droit.get(key);
			return 0;
		}
		
		public String getToken(String login){
			for(String key:tok.keySet())
				if(key.equals(login))
					return tok.get(key);
			return null;
		}
		
		public Map<String,String> getAllLogin(){return mdp;	}//1
		public Map<String,String> getAllName(){return nom;}//2
		public Map<String,String> getAllPrenom(){return prenom;}//3
		public Map<String,String> getAllAddress(){return address;}//4
		public Map<String,String> getAllMail(){return mail;}//5
		public Map<String,Date> getAllInscr(){return dateins;}//6
		public Map<String,String> getAllPhone(){return tel;}//7
		public Map<String,Integer> getAllDroit(){return droit;}//8
		public Map<String,String> getAllToken(){return tok;}//9
		
}
